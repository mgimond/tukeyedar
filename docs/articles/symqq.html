<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tukeyedar">
<title>The symmetry QQ plot • tukeyedar</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The symmetry QQ plot">
<meta property="og:description" content="tukeyedar">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tukeyedar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/polish.html">Median polish</a>
    <a class="dropdown-item" href="../articles/qq.html">The empirical QQ plot (and derived Tukey mean-difference plot)</a>
    <a class="dropdown-item" href="../articles/RLine.html">Resistant Line</a>
    <a class="dropdown-item" href="../articles/symqq.html">The symmetry QQ plot</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mgimond/tukeyedar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>The symmetry QQ plot</h1>
                        <h4 data-toc-skip class="author">Manuel
Gimond</h4>
            
            <h4 data-toc-skip class="date">2024-06-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mgimond/tukeyedar/blob/HEAD/vignettes/symqq.Rmd" class="external-link"><code>vignettes/symqq.Rmd</code></a></small>
      <div class="d-none name"><code>symqq.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The symmetry QQ plot is inspired by Chambers <em>et al.</em>’s
<strong>symmetry plot</strong> which pairs the quantiles of the lower
half of a batch of values with matching quantiles of the batch’s upper
half of values. The median value is used to define the halves as
follows:</p>
<p><span class="math display">\[
lower\ half = median - y_i\\
upper\ half = x_{n+1-i} - median
\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the number of values
in <span class="math inline">\(x\)</span>, <span class="math inline">\(i\)</span> = 1 to <span class="math inline">\(n/2\)</span> if <span class="math inline">\(n\)</span> is even or <span class="math inline">\(i\)</span> = 1 to <span class="math inline">\((n+1)/2\)</span> if <span class="math inline">\(n\)</span> is odd.</p>
<p>The plot is interpreted no differently than a QQ plot. If the data
are symmetrical about the batch’s median value, the points will hug the
1:1 line. For example, given a batch of 1000 normally distributed values
shown in the left density plot, we would expect the symmetry QQ plot to
show the points very close to the 1:1 line as shown in the right
plot.</p>
<p><img src="symqq_files/figure-html/unnamed-chunk-2-1.png" width="576"></p>
<p>The axes show the distance of each observation in the batch to that
batch’s median value. The units are those of the batch. Points that are
close to 0 are those observations closest to the median. Points that are
furthest from 0 are those that are at both tail ends of the
distribution.</p>
</div>
<div class="section level2">
<h2 id="the-symmetry-qq-plot-function">The symmetry QQ plot function<a class="anchor" aria-label="anchor" href="#the-symmetry-qq-plot-function"></a>
</h2>
<p>The symmetry QQ plot is generated using the <code><a href="../reference/eda_qq.html">eda_qq()</a></code>
function with the <code>sym = TRUE</code> argument.</p>
<p>Before exploring the function and its output, let’s first generate
some data. Here, we’ll create a slightly skewed dataset (one that is
skewed towards large values).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> </span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">100</span>, shape <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  </span></code></pre></div>
<p>Next, let’s generate the symmetry QQ plot.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mgimond.github.io/tukeyedar/">tukeyedar</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, sym <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="symqq_files/figure-html/unnamed-chunk-4-1.png" width="288"></p>
<p>If you are familiar with the use of <code>eda_qq</code> as an
empirical QQ plot function, you are familiar with the grey boxes and
dashed lines that highlight the IQR and mid 75 percent of the batch,
respectively. Here, given that the x and y axes are mapping the lower
and upper halves of the batch, the lower and upper parts of the IQR are
bounded by <code>0</code> given that <code>0</code> is the central value
of <code>x</code>. The dashed lines are to be interpreted similarly–75%
of the values are to the left of the vertical dashed line and below the
horizontal dashed line.</p>
<p>In this example, the points do not hug the 1:1 line, especially
outside of the IQR region–they curve upward away from the 1:1 line. This
is to be expected given that we generated a right skewed dataset. For
example, a point in the lower half of <code>x</code> that is about
<code>1</code> unit away of the median has a matching quantile in the
upper half of <code>x</code> that is about <code>1.4</code> units away
of the median placing it further away from the median than its lower
half counterpart. This skew becomes more pronounced as we move closer to
the tails. The furthest point away from the median is about
<code>1.4</code> units for the lower half and a little less than
<code>4</code> units away for the upper half.</p>
<p>The <code>eda_qq</code> function allows the use of a re-expression.
This feature can be helpful if one seeks to symmetrize a batch of values
using a power transformation. For example, if we wanted to render
<code>x</code> more symmetrical, we could try a power of
<code>0.5</code> (i.e. the square root) by setting the argument
<code>p = 0.5</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, sym <span class="op">=</span> <span class="cn">TRUE</span>, p <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="symqq_files/figure-html/unnamed-chunk-5-1.png" width="288"></p>
<p>Here, the square root transformation does a good job in rendering
<code>x</code> more symmetrical. Note that the points do not hug the 1:1
exactly–this is fine. What we don’t want to see is a systematic bend in
the points away from the 1:1 line. For example, if we were too
aggressive with the power transformation and chose a log transformation
(<code>p = 0</code>), we would end up with a left skewed batch of
values.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, sym <span class="op">=</span> <span class="cn">TRUE</span>, p <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="symqq_files/figure-html/unnamed-chunk-6-1.png" width="288"></p>
<p>The symmetry QQ plot can leverage <code>eda_qq</code>’s built-in
Tukey mean-difference plot (<code>md = TRUE</code>) if a finer grain
resolution of the points vis-a-vis the 1:1 line is desired. Note that
with the Tukey mean-difference plot, the x and y axes values are
different, but this need not matter since we are simply leveraging this
plot to help identify a power transformation that will give us a
symmetrical distribution.</p>
<p>Here is the original (untransformed) data in a Tukey mean-difference
plot:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, sym <span class="op">=</span> <span class="cn">TRUE</span>, md <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="symqq_files/figure-html/unnamed-chunk-7-1.png" width="288"></p>
<p>The 1:1 line is now the horizontal black line centered on 0.</p>
<p>Here’s the transformed version of the data:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, sym <span class="op">=</span> <span class="cn">TRUE</span>, md <span class="op">=</span> <span class="cn">TRUE</span>, p <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="symqq_files/figure-html/unnamed-chunk-8-1.png" width="288"></p>
</div>
<div class="section level2">
<h2 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<ul>
<li>John M. Chambers, William S. Cleveland, Beat Kleiner, Paul A. Tukey.
<em>Graphical Methods for Data Analysis</em>. 1983.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Manuel Gimond.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
