<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tukeyedar">
<title>The QQ plot • tukeyedar</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The QQ plot">
<meta property="og:description" content="tukeyedar">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tukeyedar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/polish.html">Median polish</a>
    <a class="dropdown-item" href="../articles/qq.html">The QQ plot</a>
    <a class="dropdown-item" href="../articles/RLine.html">Resistant Line</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mgimond/tukeyedar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>The QQ plot</h1>
                        <h4 data-toc-skip class="author">Manuel
Gimond</h4>
            
            <h4 data-toc-skip class="date">2023-06-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mgimond/tukeyedar/blob/HEAD/vignettes/qq.Rmd" class="external-link"><code>vignettes/qq.Rmd</code></a></small>
      <div class="d-none name"><code>qq.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <em>empirical quantile-quantile plot</em> (QQ plot) is probably
one of the most underused and least appreciated plots in univariate
analysis. It is used to compare two distributions across their
<em>full</em> range of values. It is a generalization of the boxplot in
that it does not limit the comparison to just the median and upper and
lower quartiles. In fact, it compares <em>all</em> values by matching
each value in one batch to its corresponding quantile in the other
batch. The sizes of each batch need not be the same. If they differ, the
larger batch is interpolated down to the smaller batch’s set of
quantiles.</p>
<p>A QQ plot can not only help visualize the differences in
distributions, but it can also model the relationship between both
batches. Note that this is not to be confused with modeling the
relationship between a bivariate dataset where the latter pairs up the
points by <em>observational units</em> whereas a QQ plot pairs up the
values by their “matching quantiles”.</p>
</div>
<div class="section level2">
<h2 id="anatomy-of-the-eda_qq-plot">Anatomy of the <code>eda_qq</code> plot<a class="anchor" aria-label="anchor" href="#anatomy-of-the-eda_qq-plot"></a>
</h2>
<p><img src="qq_files/figure-html/unnamed-chunk-2-1.png" width="288"></p>
<pre><code><span><span class="co">#&gt;  [1] "Suggested offsets:y = x * 1.4574 + (0.9914)"</span></span></code></pre>
<ul>
<li>Each “dot” represents matching quantiles from each batch.</li>
<li>The <em>shaded boxes</em> represent each batch’s interquartile
ranges (mid 50% of values).</li>
<li>The <em>Solid dashed lines</em> inside the shaded boxes represent
each batch’s medians.</li>
<li>The <em>lightly shaded dashed dots</em> represent each batch’s
12.5<sup>th</sup> and 87.5<sup>th</sup> quantiles (i.e. they show the
ends of the mid 80% of values).</li>
<li>The <em>upper right-hand text</em> indicates the power
transformation applied to the both batches (default is a power of
<code>1</code> which is original measurement scale). If a formula is
applied to one or both batches, it too will appear in the upper
right-hand text.</li>
<li>The <code>eda_qq</code> will also output the <em>suggested
relationship</em> between the y variable and the x variable. It bases
this on each batch’s interquartile values.</li>
</ul>
</div>
<div class="section level2">
<h2 id="an-overview-of-some-of-the-function-arguments">An overview of some of the function arguments<a class="anchor" aria-label="anchor" href="#an-overview-of-some-of-the-function-arguments"></a>
</h2>
<div class="section level3">
<h3 id="data-type">Data type<a class="anchor" aria-label="anchor" href="#data-type"></a>
</h3>
<p>The function will accept a <em>dataframe</em> with a values column
and a group column, or it will accept <em>two separate vector
objects</em>. For example, to pass two separate vector object,
<code>x</code> and <code>y</code>, type:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mgimond.github.io/tukeyedar/" class="external-link">tukeyedar</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">207</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span></span>
<span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-3-1.png" width="288"></p>
<p>If the data are in a dataframe, type:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">val</span>, <span class="va">cat</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-4-1.png" width="288"></p>
</div>
<div class="section level3">
<h3 id="suppressing-plot">Suppressing plot<a class="anchor" aria-label="anchor" href="#suppressing-plot"></a>
</h3>
<p>You can suppress the plot and have the x and y values outputted to a
list. If the batches did not match in size, the output will show their
interpolated values such that the output batches match in size.</p>
<p>The output will also include the power parameter applied to both
batches as well as any formula applied to one or both batches
(<code>fx</code> is the formula applied to the x variable and
<code>fy</code> is the formula applied to the y variable).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Suggested offsets:y = x * 1.1201 + (0.5618)"</span></span>
<span><span class="va">out</span></span>
<span><span class="co">#&gt;  $x</span></span>
<span><span class="co">#&gt;   [1] -2.0207122 -1.6048333 -1.5620907 -1.5128732 -1.3126378 -1.1770882</span></span>
<span><span class="co">#&gt;   [7] -1.0871906 -0.9258832 -0.8896555 -0.6152073 -0.3140113 -0.2996734</span></span>
<span><span class="co">#&gt;  [13] -0.2954234 -0.2199849 -0.2108781  0.1202060  0.2608893  0.2680445</span></span>
<span><span class="co">#&gt;  [19]  0.2910663  0.4239690  0.4262605  0.4301416  0.5176361  0.6085180</span></span>
<span><span class="co">#&gt;  [25]  0.6880919  0.6929772  0.7640838  0.9037644  1.0124869  1.0503544</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  $y</span></span>
<span><span class="co">#&gt;   [1] -2.10710669 -1.30465821 -1.17618932 -1.17253191 -0.86423268 -0.40162859</span></span>
<span><span class="co">#&gt;   [7] -0.37002087 -0.19629536 -0.07210822 -0.01829722  0.05826287  0.09105884</span></span>
<span><span class="co">#&gt;  [13]  0.09371398  0.13698992  0.22318119  0.43006689  0.52597363  0.72665767</span></span>
<span><span class="co">#&gt;  [19]  0.81351407  1.00612388  1.01831440  1.06713353  1.23708449  1.24360530</span></span>
<span><span class="co">#&gt;  [25]  1.33232007  1.43973056  1.59125312  1.64852115  1.77464625  1.93823390</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  $p</span></span>
<span><span class="co">#&gt;  [1] 1</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  $fx</span></span>
<span><span class="co">#&gt;  NULL</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  $fy</span></span>
<span><span class="co">#&gt;  NULL</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="setting-the-grey-box-and-dashed-line-parameters">Setting the grey box and dashed line parameters<a class="anchor" aria-label="anchor" href="#setting-the-grey-box-and-dashed-line-parameters"></a>
</h3>
<p>The grey box highlights the interquartile ranges for both batches.
Its boundary can be modified via the <code>b.val</code> argument.
Likewise, the lightly shaded dashed dots that highlight the mid 80% of
values can be modified via the <code>l.val</code> argument.</p>
<p>For example, to highlight the mid 68% of values using the grey boxes
and the mid 95% of values using the lightly shaded dashed dots,
type:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, b.val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.16</span>, <span class="fl">0.84</span><span class="op">)</span>, l.val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-6-1.png" width="288"></p>
<p>You can suppress the plotting of the grey box and the lightly shaded
dashed dots by setting <code>q = FALSE</code>. This does not affect the
median dashed lines.</p>
</div>
<div class="section level3">
<h3 id="applying-a-formula-to-one-of-the-batches">Applying a formula to one of the batches<a class="anchor" aria-label="anchor" href="#applying-a-formula-to-one-of-the-batches"></a>
</h3>
<p>You can apply a formula to a batch via the <code>fx</code> argument
for the x-variable and the <code>fy</code> argument for the y-variable.
The formula is passed as a text string. For example, to add
<code>0.5</code> to the x values, type:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fx <span class="op">=</span> <span class="st">"x + 0.5"</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-7-1.png" width="288"></p>
</div>
<div class="section level3">
<h3 id="quantile-type">Quantile type<a class="anchor" aria-label="anchor" href="#quantile-type"></a>
</h3>
<p>There are many different quantile algorithms available in R. To see
the full list of quantile types, refer to the quantile help page:
<code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">?quantile</a></code>. By default, <code><a href="../reference/eda_qq.html">eda_qq()</a></code> adopts
<code>q.type = 5</code>. In general, the choice of quantiles will not
really matter, especially for large datasets. If you want to adopt R’s
default type, set <code>q.type = 7</code>.</p>
</div>
<div class="section level3">
<h3 id="point-symbols">Point symbols<a class="anchor" aria-label="anchor" href="#point-symbols"></a>
</h3>
<p>The point symbol type, color and size can be modified via the
<code>pch</code>, <code>p.col</code> (and/or <code>p-fill</code>) and
<code>size</code> arguments. The color can be either a built-in color
name (you can see the full list by typing <code><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colors()</a></code>) or the
<code><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb()</a></code> function. If you define the color using one of the
built-in color names, you can adjust its transparency via the
<code>alpha</code> argument. A value of <code>0</code> renders the point
completely transparent and a value of <code>1</code> renders the point
completely opaque. The point symbol can take on two color parameters
depending on point type. If <code>pch</code> is any number between 21
and 25, <code>p.fill</code> will define its fill color and
<code>p.col</code> will define its border color. For any other point
symbol type, the <code>p.fill</code> argument is ignored.</p>
<p>Here are a few examples:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, p.fill <span class="op">=</span> <span class="st">"bisque"</span>, p.col <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-8-1.png" width="288"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch <span class="op">=</span> <span class="fl">16</span>, p.col <span class="op">=</span> <span class="st">"tomato2"</span>, size <span class="op">=</span> <span class="fl">1.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-9-1.png" width="288"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch <span class="op">=</span> <span class="fl">3</span>, p.col <span class="op">=</span> <span class="st">"tomato2"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-10-1.png" width="288"></p>
</div>
</div>
<div class="section level2">
<h2 id="interpreting-a-qq-plot">Interpreting a QQ plot<a class="anchor" aria-label="anchor" href="#interpreting-a-qq-plot"></a>
</h2>
<p>To help interpret the following QQ plots, we’ll compare each plot to
matching kernel density plots. We’ll start with a simple example</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mgimond.github.io/tukeyedar/" class="external-link">tukeyedar</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">543</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">2</span></span>
<span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/eda_dens.html">eda_dens</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">0.5</span></span>
<span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/eda_dens.html">eda_dens</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fl">2</span></span>
<span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/eda_dens.html">eda_dens</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">540</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="va">x2</span> <span class="op">+</span> <span class="fl">0.2</span> </span>
<span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x2</span>,<span class="va">y2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/eda_dens.html">eda_dens</a></span><span class="op">(</span><span class="va">x2</span>,<span class="va">y2</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="power-transformation">Power transformation<a class="anchor" aria-label="anchor" href="#power-transformation"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Indometh</span>, <span class="va">Subject</span> <span class="op">==</span> <span class="fl">1</span>, select <span class="op">=</span> <span class="va">conc</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Indometh</span>, <span class="va">Subject</span> <span class="op">==</span> <span class="fl">2</span>, select <span class="op">=</span> <span class="va">conc</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-16-1.png" width="288"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span>, p <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-16-2.png" width="288"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">s1</span>,<span class="va">s2</span>,p<span class="op">=</span><span class="fl">0</span>,fx<span class="op">=</span><span class="st">"x * 0.8501 + 0.3902"</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-16-3.png" width="288"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eda_dens.html">eda_dens</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-17-1.png" width="288"></p>
<div class="section level3">
<h3 id="the-tukey-mean-difference-plot">The Tukey mean-difference plot<a class="anchor" aria-label="anchor" href="#the-tukey-mean-difference-plot"></a>
</h3>
<p>This is simply an extension of the QQ plot whereby the plot is
rotated such that the 45° line (the 1:1 slope) becomes horizontal. This
can be useful in helping identify subtle differences between batches.
The plot is rotated 45° by mapping the difference between both batches
to the y-axis, and mapping the mean between both batches to the x-axis.
For example, the following figure on the left (the QQ plot) shows the
additive offset between both batches but it fails to show the
multiplicative offset. The latter can be clearly seen in the Tukey
mean-difference plot (on the right) which can be invoked by setting the
argument <code>md = TRUE</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">0.97</span> <span class="op">+</span> <span class="fl">0.3</span></span>
<span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, md <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-18-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="a-working-example">A working example<a class="anchor" aria-label="anchor" href="#a-working-example"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old</span> <span class="op">&lt;-</span> <span class="va">wat95</span><span class="op">$</span><span class="va">avg</span> <span class="co"># legacy temperature normals</span></span>
<span><span class="va">new</span> <span class="op">&lt;-</span> <span class="va">wat05</span><span class="op">$</span><span class="va">avg</span> <span class="co"># current temperature normals</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">old</span>, <span class="va">new</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-19-1.png" width="288"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old</span> <span class="op">&lt;-</span> <span class="va">wat95</span><span class="op">$</span><span class="va">avg</span> <span class="co"># legacy temperature normals</span></span>
<span><span class="va">new</span> <span class="op">&lt;-</span> <span class="va">wat05</span><span class="op">$</span><span class="va">avg</span> <span class="co"># current temperature normals</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">old</span>, <span class="va">new</span>, md <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-20-1.png" width="288"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"mid"</span>, <span class="st">"high"</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">avg</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">6</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">out</span>, <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">avg</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">avg</span><span class="op">)</span>, <span class="fl">35</span>, <span class="fl">50</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">avg</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                       labels <span class="op">=</span> <span class="va">labs</span>, include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">labs</span>, FUN <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">out2</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>, <span class="va">out2</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">y</span> ,</span>
<span>                                xlab <span class="op">=</span> <span class="st">"old"</span>, ylab <span class="op">=</span> <span class="st">"new"</span>, md <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="va">x</span>, line <span class="op">=</span> <span class="fl">3</span>, col.main <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span><span class="op">}</span> <span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-22-1.png" width="864"></p>
<pre><code><span><span class="co">#&gt;  [1] "Suggested offsets:y = x * 0.9506 + (1.661)"</span></span>
<span><span class="co">#&gt;  [1] "Suggested offsets:y = x * 1.0469 + (-1.6469)"</span></span>
<span><span class="co">#&gt;  [1] "Suggested offsets:y = x * 0.9938 + (0.9268)"</span></span></code></pre>
<p>What not to do:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"mid"</span>, <span class="st">"high"</span><span class="op">)</span></span>
<span><span class="va">old.split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">old</span>, <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">old</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">old</span><span class="op">)</span>, <span class="fl">35</span>, <span class="fl">50</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">old</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                            labels <span class="op">=</span> <span class="va">labs</span>, include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">new.split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">new</span>, <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">new</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span>, <span class="fl">35</span>, <span class="fl">50</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                            labels <span class="op">=</span> <span class="va">labs</span>, include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">labs</span>, FUN <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">old.split</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, <span class="va">new.split</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span> ,</span>
<span>                                xlab <span class="op">=</span> <span class="st">"old"</span>, ylab <span class="op">=</span> <span class="st">"new"</span>, md <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="va">x</span>, line <span class="op">=</span> <span class="fl">3</span>, col.main <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span><span class="op">}</span> <span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-23-1.png" width="864"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x * 0.9636 + 1.4411"</span>, </span>
<span>           <span class="st">"x * 0.9838 + 0.7478"</span>,</span>
<span>           <span class="st">"x * 1.0365 - 2.0333"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">xform</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">labs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">labs</span>, FUN <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="../reference/eda_qq.html">eda_qq</a></span><span class="op">(</span><span class="va">old.split</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, <span class="va">new.split</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span> , </span>
<span>                                fx <span class="op">=</span> <span class="va">xform</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>                                xlab <span class="op">=</span> <span class="st">"old"</span>, ylab <span class="op">=</span> <span class="st">"new"</span>, md <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>; </span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="va">x</span>, line <span class="op">=</span> <span class="fl">3</span>, col.main <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span><span class="op">}</span> <span class="op">)</span></span></code></pre></div>
<p><img src="qq_files/figure-html/unnamed-chunk-24-1.png" width="864"></p>
<p>The characterization of the differences in normal temperatures
between the old and new set of normals can be formalized as follows:</p>
<p><span class="math display">\[
new = \begin{cases}
old * 0.9636 + 1.4411, &amp;  T_{avg} &lt; 35 \\
old * 0.9838 + 0.7478, &amp; 35 \le T_{avg} &lt; 50  \\
old * 1.0365 - 2.0333, &amp; T_{avg} \ge 50
\end{cases}
\]</span></p>
<p>The key takeaways from this analysis can be summarized as
follows:</p>
<ul>
<li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Manuel Gimond.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
