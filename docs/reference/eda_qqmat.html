<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>QQ plot matrix — eda_qqmat • tukeyedar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="QQ plot matrix — eda_qqmat"><meta name="description" content="eda_qqmat Generates a matrix of empirical QQ plots"><meta property="og:description" content="eda_qqmat Generates a matrix of empirical QQ plots"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tukeyedar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/polish.html">Median polish</a></li>
    <li><a class="dropdown-item" href="../articles/qq.html">The empirical QQ plot (and derived Tukey mean-difference plot)</a></li>
    <li><a class="dropdown-item" href="../articles/rfs.html">The residual-fit spread plot</a></li>
    <li><a class="dropdown-item" href="../articles/RLine.html">Resistant Line</a></li>
    <li><a class="dropdown-item" href="../articles/symqq.html">The symmetry QQ plot</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mgimond/tukeyedar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>QQ plot matrix</h1>
      <small class="dont-index">Source: <a href="https://github.com/mgimond/tukeyedar/blob/HEAD/R/eda_qqmat.R" class="external-link"><code>R/eda_qqmat.R</code></a></small>
      <div class="d-none name"><code>eda_qqmat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>eda_qqmat</code> Generates a matrix of empirical QQ plots</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eda_qqmat</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">fac</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tukey <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  q.type <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stat <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grey <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  p.col <span class="op">=</span> <span class="st">"grey40"</span>,</span>
<span>  p.fill <span class="op">=</span> <span class="st">"grey60"</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  text.size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  tail.pch <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  tail.p.col <span class="op">=</span> <span class="st">"grey70"</span>,</span>
<span>  tail.p.fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tic.size <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  q <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tails <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  med <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  inner <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>Data frame.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Continuous variable.</p></dd>


<dt id="arg-fac">fac<a class="anchor" aria-label="anchor" href="#arg-fac"></a></dt>
<dd><p>Categorical variable.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Power transformation to apply to the continuous variable.</p></dd>


<dt id="arg-tukey">tukey<a class="anchor" aria-label="anchor" href="#arg-tukey"></a></dt>
<dd><p>Boolean determining if a Tukey transformation should be adopted
(FALSE adopts a Box-Cox transformation).</p></dd>


<dt id="arg-q-type">q.type<a class="anchor" aria-label="anchor" href="#arg-q-type"></a></dt>
<dd><p>An integer between 1 and 9 selecting one of the nine quantile
algorithms. (See <code>quantile</code>tile function).</p></dd>


<dt id="arg-diag">diag<a class="anchor" aria-label="anchor" href="#arg-diag"></a></dt>
<dd><p>Boolean determining if both upper and lower triangular matrix
should be plotted. If set to <code>FALSE</code>, only the lower triangular matrix
is plotted.</p></dd>


<dt id="arg-xylim">xylim<a class="anchor" aria-label="anchor" href="#arg-xylim"></a></dt>
<dd><p>X and Y axes limits.</p></dd>


<dt id="arg-resid">resid<a class="anchor" aria-label="anchor" href="#arg-resid"></a></dt>
<dd><p>Boolean determining if residuals should be plotted. Residuals
are computed using the <code>stat</code> parameter.</p></dd>


<dt id="arg-stat">stat<a class="anchor" aria-label="anchor" href="#arg-stat"></a></dt>
<dd><p>Statistic to use if residuals are to be computed. Currently
<code>mean</code> (default) or <code>median</code>.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Boolean determining if plot should be generated.</p></dd>


<dt id="arg-grey">grey<a class="anchor" aria-label="anchor" href="#arg-grey"></a></dt>
<dd><p>Grey level to apply to plot elements (0 to 1 with 1 = black).</p></dd>


<dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>Point symbol type.</p></dd>


<dt id="arg-p-col">p.col<a class="anchor" aria-label="anchor" href="#arg-p-col"></a></dt>
<dd><p>Color for point symbol.</p></dd>


<dt id="arg-p-fill">p.fill<a class="anchor" aria-label="anchor" href="#arg-p-fill"></a></dt>
<dd><p>Point fill color passed to <code>bg</code> (Only used for <code>pch</code>
ranging from 21-25).</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>Point symbol size (0-1).</p></dd>


<dt id="arg-text-size">text.size<a class="anchor" aria-label="anchor" href="#arg-text-size"></a></dt>
<dd><p>Size for category text in diagonal box.</p></dd>


<dt id="arg-tail-pch">tail.pch<a class="anchor" aria-label="anchor" href="#arg-tail-pch"></a></dt>
<dd><p>Tail-end point symbol type (See <code>tails</code>).</p></dd>


<dt id="arg-tail-p-col">tail.p.col<a class="anchor" aria-label="anchor" href="#arg-tail-p-col"></a></dt>
<dd><p>Tail-end color for point symbol (See <code>tails</code>).</p></dd>


<dt id="arg-tail-p-fill">tail.p.fill<a class="anchor" aria-label="anchor" href="#arg-tail-p-fill"></a></dt>
<dd><p>Tail-end point fill color passed to <code>bg</code>
(Only used for <code>tail.pch</code> ranging from 21-25).</p></dd>


<dt id="arg-tic-size">tic.size<a class="anchor" aria-label="anchor" href="#arg-tic-size"></a></dt>
<dd><p>Size of tic labels (defaults to 0.8).</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Point transparency (0 = transparent, 1 = opaque). Only
applicable if <code><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb()</a></code> is not used to define point colors.</p></dd>


<dt id="arg-q">q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>Boolean determining if grey box highlighting the <code>inner</code>
region should be displayed.</p></dd>


<dt id="arg-tails">tails<a class="anchor" aria-label="anchor" href="#arg-tails"></a></dt>
<dd><p>Boolean determining if points outside of the <code>inner</code> region
 should be symbolized differently. Tail-end points are symbolized via the
<code>tail.pch</code>, <code>tail.p.col</code> and <code>tail.p.fill</code> arguments.</p></dd>


<dt id="arg-med">med<a class="anchor" aria-label="anchor" href="#arg-med"></a></dt>
<dd><p>Boolean determining if median lines should be drawn.</p></dd>


<dt id="arg-inner">inner<a class="anchor" aria-label="anchor" href="#arg-inner"></a></dt>
<dd><p>Fraction of mid-values to highlight in <code>q</code> or <code>tails</code>.
Defaults to the inner 75% of values.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Not used</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list with the following components:</p>
<ul><li><p><code>data</code>: List with input <code>x</code> and <code>y</code> values for each
  group. May be interpolated to smallest quantile batch if batch sizes
  don't match. Values will reflect power transformation defined in <code>p</code>.</p></li>
<li><p><code>p</code>: Transformation applied to original values.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function will generate an empirical QQ plot matrix from a
dataframe of continuous values and matching categories. The function is
designed to place emphasis on the mid portion of the data. The mid portion
range is defined by <code>inner</code> (the inner fraction of the data). By default,
the points outside of the mid portion of the data are symbolized differently.
You can also highlight the mid region in light grey by setting
<code>q = TRUE</code>. The median of both batches are shown in vertical and
horizontal dashed lines. For a plain vanilla QQ plot matrix you can remove
all guides by setting <code>tails = FALSE</code> and  <code>mid = FALSE</code>.</p>
<p>The QQ plot matrix is most effective in comparing residuals after the data
are fitted by the mean or median. To plot the residuals, set
<code>resid=TRUE</code>. By default, the <code>mean</code> is used. You can change the
statistic to the median by setting <code>stat=median</code>.</p>
<p>The function also allows for batch transformation of values via the
<code>p</code> argument. The transformation is applied to the data prior to
computing the residuals.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>John M. Chambers, William S. Cleveland, Beat Kleiner, Paul A. Tukey.
  Graphical Methods for Data Analysis (1983)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default output</span></span></span>
<span class="r-in"><span><span class="va">singer</span> <span class="op">&lt;-</span> <span class="fu">lattice</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lattice/man/singer.html" class="external-link">singer</a></span></span></span>
<span class="r-in"><span><span class="fu">eda_qqmat</span><span class="op">(</span><span class="va">singer</span>, <span class="va">height</span>, <span class="va">voice.part</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="eda_qqmat-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Limit to lower triangular matrix</span></span></span>
<span class="r-in"><span><span class="fu">eda_qqmat</span><span class="op">(</span><span class="va">singer</span>, <span class="va">height</span>, <span class="va">voice.part</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="eda_qqmat-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot residuals after fitting mean model</span></span></span>
<span class="r-in"><span><span class="fu">eda_qqmat</span><span class="op">(</span><span class="va">singer</span>, <span class="va">height</span>, <span class="va">voice.part</span>, resid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="eda_qqmat-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate plain vanilla QQ plot matrix</span></span></span>
<span class="r-in"><span><span class="fu">eda_qqmat</span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">mpg</span>, <span class="va">cyl</span>,resid <span class="op">=</span> <span class="cn">TRUE</span>, tails <span class="op">=</span> <span class="cn">FALSE</span>, med <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="eda_qqmat-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Log transform the data, then plot the residuals after fitting the mean model</span></span></span>
<span class="r-in"><span><span class="fu">eda_qqmat</span><span class="op">(</span><span class="va">iris</span>, <span class="va">Petal.Length</span>, <span class="va">Species</span>, resid <span class="op">=</span> <span class="cn">TRUE</span>, p <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note that a power transformation of 0 was applied to the data before they were processed for the plot.</span>
<span class="r-plt img"><img src="eda_qqmat-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit the median model instead of the mean</span></span></span>
<span class="r-in"><span><span class="fu">eda_qqmat</span><span class="op">(</span><span class="va">iris</span>, <span class="va">Petal.Length</span>, <span class="va">Species</span>, resid <span class="op">=</span> <span class="cn">TRUE</span>, p <span class="op">=</span> <span class="fl">0</span>, stat <span class="op">=</span> <span class="va">median</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note that a power transformation of 0 was applied to the data before they were processed for the plot.</span>
<span class="r-plt img"><img src="eda_qqmat-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fill inner region with grey boxes</span></span></span>
<span class="r-in"><span><span class="fu">eda_qqmat</span><span class="op">(</span><span class="va">iris</span>, <span class="va">Petal.Length</span>, <span class="va">Species</span>, resid <span class="op">=</span> <span class="cn">TRUE</span>, q <span class="op">=</span> <span class="cn">TRUE</span>, p <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note that a power transformation of 0 was applied to the data before they were processed for the plot.</span>
<span class="r-plt img"><img src="eda_qqmat-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change tail point symbol</span></span></span>
<span class="r-in"><span><span class="fu">eda_qqmat</span><span class="op">(</span><span class="va">iris</span>, <span class="va">Petal.Length</span>, <span class="va">Species</span>, resid <span class="op">=</span> <span class="cn">TRUE</span>, p <span class="op">=</span> <span class="fl">0</span>, tail.pch <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note that a power transformation of 0 was applied to the data before they were processed for the plot.</span>
<span class="r-plt img"><img src="eda_qqmat-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change inner region point symbols to dark orange and reduce size of all</span></span></span>
<span class="r-in"><span><span class="co"># point symbols</span></span></span>
<span class="r-in"><span><span class="fu">eda_qqmat</span><span class="op">(</span><span class="va">iris</span>, <span class="va">Petal.Length</span>, <span class="va">Species</span>, resid <span class="op">=</span> <span class="cn">TRUE</span>, p <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>          tail.pch <span class="op">=</span> <span class="fl">3</span>, p.fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note that a power transformation of 0 was applied to the data before they were processed for the plot.</span>
<span class="r-plt img"><img src="eda_qqmat-9.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Manuel Gimond.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

