<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="eda_rfs generates a Cleveland residual-fit spread plot
   for univariate or bivariate data."><title>Residual-Fit Spread Plot — eda_rfs • tukeyedar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Residual-Fit Spread Plot — eda_rfs"><meta property="og:description" content="eda_rfs generates a Cleveland residual-fit spread plot
   for univariate or bivariate data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tukeyedar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/polish.html">Median polish</a>
    <a class="dropdown-item" href="../articles/qq.html">The empirical QQ plot (and derived Tukey mean-difference plot)</a>
    <a class="dropdown-item" href="../articles/rfs.html">The residual-fit spread plot</a>
    <a class="dropdown-item" href="../articles/RLine.html">Resistant Line</a>
    <a class="dropdown-item" href="../articles/symqq.html">The symmetry QQ plot</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mgimond/tukeyedar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Residual-Fit Spread Plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/mgimond/tukeyedar/blob/HEAD/R/eda_rfs.R" class="external-link"><code>R/eda_rfs.R</code></a></small>
      <div class="d-none name"><code>eda_rfs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>eda_rfs</code> generates a Cleveland residual-fit spread plot
   for univariate or bivariate data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eda_rfs</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tukey <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.par <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stat <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  grey <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  p.col <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  p.fill <span class="op">=</span> <span class="st">"grey80"</span>,</span>
<span>  inner <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  q <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bar <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dat</dt>
<dd><p>An eda_lm model, an lm model or a dataframe of univariate data.</p></dd>


<dt>x</dt>
<dd><p>Column of values if <code>dat</code> is a dataframe, ignored otherwise.</p></dd>


<dt>grp</dt>
<dd><p>Column of grouping variables if <code>dat</code> is a dataframe, ignored
otherwise.</p></dd>


<dt>p</dt>
<dd><p>Power transformation to apply to univariate data. Ignored if linear
model is passed to function.</p></dd>


<dt>tukey</dt>
<dd><p>Boolean determining if a Tukey transformation should be adopted
(<code>TRUE</code>) or if a Box-Cox transformation should be adopted (<code>FALSE</code>).</p></dd>


<dt>show.par</dt>
<dd><p>Boolean determining if the power transformation used with the
data should be displayed in the plot's upper-right corner.</p></dd>


<dt>stat</dt>
<dd><p>Choice of summary statistic to use when centering the fitted
values around 0. The <code>stat</code> parameter is also used for fitting
univariate values (i.e. for summarizing groups). <code>stat</code> can be either
<code>mean</code> or <code>median</code>.</p></dd>


<dt>grey</dt>
<dd><p>Grey level to apply to plot elements (0 to 1 with 1 = black).</p></dd>


<dt>pch</dt>
<dd><p>Point symbol type.</p></dd>


<dt>p.col</dt>
<dd><p>Color for point symbol.</p></dd>


<dt>p.fill</dt>
<dd><p>Point fill color passed to <code>bg</code> (Only used for <code>pch</code>
ranging from 21-25).</p></dd>


<dt>inner</dt>
<dd><p>Fraction of values that should be captured by the inner color
band of the normal and density plots. Defaults to 0.9 (inner 90% of
values).</p></dd>


<dt>q</dt>
<dd><p>Boolean determining if grey quantile boxes should be plotted.</p></dd>


<dt>size</dt>
<dd><p>Point size (0-1)</p></dd>


<dt>alpha</dt>
<dd><p>Point transparency (0 = transparent, 1 = opaque). Only
applicable if <code><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb()</a></code> is not used to define point colors.</p></dd>


<dt>ylim</dt>
<dd><p>Define custom y axis limits.</p></dd>


<dt>bar</dt>
<dd><p>Boolean determining if spread comparison stacked bar should be
plotted.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>No values are returned</p>


    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>eda_rfs</code> function generates a residual-fit spread plot for
univariate and bivariate data. Input can be a dataframe with one column
storing the continuous variable and another column storing the categorical
(grouping) variable or, for a bivariate dataset, a model output from an
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, <code><a href="eda_lm.html">eda_lm()</a></code> or <code><a href="eda_rline.html">eda_rline()</a></code> function.<br><br>
The <code>stat</code> argument only applies to univariate data and allows the user
to choose the summary statistic to fit to the data (either mean or median).
This statistic is also used to recenter the fitted values in the rfs plot.<br><br>
The <code>q</code> argument, when set to <code>TRUE</code>, will add a shaded region to
the residual quantile plot highlighting the mid portion of the data defined
by the <code>inner</code> argument (set to 90<!-- % of the mid values, by default). The -->
range defined by the mid portion of the data is highlighted in the left plot
for comparison with the the full range defined by the fitted values. <br><br>
The <code>inner</code> argument is the fraction of mid values to display with the
shaded region if <code>q = TRUE</code> and the fraction used to define the
residual's spread in the console output.<br><br>
The <code>bar</code> option, when set to <code>TRUE</code>, adds a narrow stacked barplot
that compares the spread covered by the residuals (red bar) with the spread
covered by the fitted values (green bar). The residual spread is computed
for the portion of the residuals defined by the <code>inner</code> argument. The
values outputted in the console are those used in computing the vertical
bars.<br><br>
A stacked bar plot (<code>bar = TRUE</code>) can be added to the plot to highlight
the relative spreads between fitted values and residuals. Note that the
residual spread is defined by the <code>inner</code> argument. The red bar is
the relative spread of the residuals and the green bar is the relative
spread of the fitted values. The stacked bar plot can be helpful in quickly
gauging the effect the fitted values have in explaining the variability in
the data. The longer the green bar relative to the red bar, the greater the
grouping variable's (for univariate data) or linear model's (for bivariate
data) effect in minimizing the uncertainty in the estimated value.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>William S. Cleveland. Visualizing Data. Hobart Press (1993)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a basic residual-fit spread plot</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 9.74 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 11.56 units, or about 118.7% of the mid 90.0% of residuals.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add inner 90% region to residuals (grey boxes in plot)</span></span></span>
<span class="r-in"><span><span class="co"># Vertical grey box shows matching y-values</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span>, q <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 9.74 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 11.56 units, or about 118.7% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="eda_rfs-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change guide to encompass mid 75% of residual values</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span>, q <span class="op">=</span> <span class="cn">TRUE</span>, inner <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 75.0% of residuals covers about 7.70 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 11.56 units, or about 150.1% of the mid 75.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use median instead of the mean to compute group summaries and to</span></span></span>
<span class="r-in"><span><span class="co"># recenter the fitted values around 0.</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span>, stat <span class="op">=</span> <span class="va">median</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 9.99 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 10.80 units, or about 108.1% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apply power transformation of -1 to mpg. Defaults to box-cox method.</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span>, p <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 0.03 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 0.03 units, or about 101.0% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display a stacked bar plot showing relative importance in spreads</span></span></span>
<span class="r-in"><span><span class="co"># between fitted values and residuals.</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span>, bar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 9.74 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 11.56 units, or about 118.7% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate rfs plot for bivariate model output. Model can be generated from</span></span></span>
<span class="r-in"><span><span class="co"># lm(), eda_lm() or eda_rline()</span></span></span>
<span class="r-in"><span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">hp</span> <span class="op">~</span> <span class="va">mpg</span>, <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">M1</span>,q <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 112.42 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 207.50 units, or about 184.6% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="eda_lm.html">eda_lm</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">mpg</span>, <span class="va">hp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="eda_rfs-8.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        int      mpg^1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 324.082314  -8.829731 </span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">M2</span>,q <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 112.42 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 207.50 units, or about 184.6% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M3</span> <span class="op">&lt;-</span> <span class="fu"><a href="eda_rline.html">eda_rline</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">mpg</span>, <span class="va">hp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">M3</span>, q <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 122.52 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 252.28 units, or about 205.9% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-10.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Manuel Gimond.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

