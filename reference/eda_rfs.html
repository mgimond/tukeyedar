<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Residual-Fit Spread Plot — eda_rfs • tukeyedar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Residual-Fit Spread Plot — eda_rfs"><meta name="description" content="eda_rfs generates a Cleveland residual-fit spread plot
   for univariate or bivariate data."><meta property="og:description" content="eda_rfs generates a Cleveland residual-fit spread plot
   for univariate or bivariate data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tukeyedar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/polish.html">Median polish</a></li>
    <li><a class="dropdown-item" href="../articles/qq.html">The empirical QQ plot (and derived Tukey mean-difference plot)</a></li>
    <li><a class="dropdown-item" href="../articles/rfs.html">The residual-fit spread plot</a></li>
    <li><a class="dropdown-item" href="../articles/RLine.html">Resistant Line</a></li>
    <li><a class="dropdown-item" href="../articles/symqq.html">The symmetry QQ plot</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mgimond/tukeyedar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Residual-Fit Spread Plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/mgimond/tukeyedar/blob/main/R/eda_rfs.R" class="external-link"><code>R/eda_rfs.R</code></a></small>
      <div class="d-none name"><code>eda_rfs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>eda_rfs</code> generates a Cleveland residual-fit spread plot
   for univariate or bivariate data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eda_rfs</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tukey <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.par <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stat <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  grey <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  p.col <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  p.fill <span class="op">=</span> <span class="st">"grey80"</span>,</span>
<span>  inner <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  q <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bar <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>An eda_lm model, an lm model or a dataframe of univariate data.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Column of values if <code>dat</code> is a dataframe, ignored otherwise.</p></dd>


<dt id="arg-grp">grp<a class="anchor" aria-label="anchor" href="#arg-grp"></a></dt>
<dd><p>Column of categorical variable if <code>dat</code> is a dataframe, ignored
otherwise.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Power transformation to apply to univariate data. Ignored if linear
model is passed to function.</p></dd>


<dt id="arg-tukey">tukey<a class="anchor" aria-label="anchor" href="#arg-tukey"></a></dt>
<dd><p>Boolean determining if a Tukey transformation should be adopted
(<code>TRUE</code>) or if a Box-Cox transformation should be adopted (<code>FALSE</code>).</p></dd>


<dt id="arg-show-par">show.par<a class="anchor" aria-label="anchor" href="#arg-show-par"></a></dt>
<dd><p>Boolean determining if the power transformation used with the
data should be displayed in the plot's upper-right corner.</p></dd>


<dt id="arg-stat">stat<a class="anchor" aria-label="anchor" href="#arg-stat"></a></dt>
<dd><p>Choice of summary statistic to use when centering the fitted
values around 0. The <code>stat</code> parameter is also used for fitting
univariate values (i.e. for summarizing groups). <code>stat</code> can be either
<code>mean</code> or <code>median</code>.</p></dd>


<dt id="arg-grey">grey<a class="anchor" aria-label="anchor" href="#arg-grey"></a></dt>
<dd><p>Grey level to apply to plot elements (0 to 1 with 1 = black).</p></dd>


<dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>Point symbol type.</p></dd>


<dt id="arg-p-col">p.col<a class="anchor" aria-label="anchor" href="#arg-p-col"></a></dt>
<dd><p>Color for point symbol.</p></dd>


<dt id="arg-p-fill">p.fill<a class="anchor" aria-label="anchor" href="#arg-p-fill"></a></dt>
<dd><p>Point fill color passed to <code>bg</code> (Only used for <code>pch</code>
ranging from 21-25).</p></dd>


<dt id="arg-inner">inner<a class="anchor" aria-label="anchor" href="#arg-inner"></a></dt>
<dd><p>Fraction of values that should be captured by the shaded region.
Defaults to inner 90% of values.</p></dd>


<dt id="arg-q">q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>Boolean determining if grey quantile boxes should be plotted.</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>Point size (0-1)</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Point transparency (0 = transparent, 1 = opaque). Only
applicable if <code><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb()</a></code> is not used to define point colors.</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>Define custom y axis limits.</p></dd>


<dt id="arg-bar">bar<a class="anchor" aria-label="anchor" href="#arg-bar"></a></dt>
<dd><p>Boolean determining if spread comparison stacked bars should be
plotted.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>No values are returned</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>eda_rfs</code> function generates a residual-fit spread plot for
univariate and bivariate data. Input can be a dataframe with one column
storing the continuous variable and another column storing the categorical
(grouping) variable or, for a bivariate dataset, a model output from an
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, <code><a href="eda_lm.html">eda_lm()</a></code> or <code><a href="eda_rline.html">eda_rline()</a></code> function.<br><br>
The <code>stat</code> argument only applies to univariate data and allows the user
to choose the summary statistic to fit to the data (either mean or median).
This statistic is also used to recenter the fitted values in the rfs plot.<br><br>
The <code>q</code> argument, when set to <code>TRUE</code>, will add a shaded region to
the residual quantile plot highlighting the mid portion of the data defined
by the <code>inner</code> argument (set to 90% of the mid values, by default). The
range defined by the mid portion of the data is highlighted in the left plot
for comparison with the the full range defined by the fitted values. <br><br>
The <code>bar</code> option, when set to <code>TRUE</code>, adds a narrow stacked barplot
that compares the spread covered by the residuals (red bar) with the spread
covered by the fitted values (green bar). The residual spread is computed
for the portion of the residuals defined by the <code>inner</code> argument. The
values outputted in the console are those used in computing the vertical
bars. The red bar is the relative spread of the residuals and the green bar
is the relative spread of the fitted values. The stacked bar plot can be
helpful in quickly gauging the effect the fitted values have in explaining
the variability in the data. The longer the green bar relative to the red
bar, the greater the grouping variable's (for univariate data) or linear
model's (for bivariate data) effect in minimizing the uncertainty in the
estimated value.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>William S. Cleveland. Visualizing Data. Hobart Press (1993)</p></li>
<li><p><a href="../articles/rfs.html">Residual-fit spread article</a></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a basic residual-fit spread plot</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 9.74 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 11.56 units, or about 118.7% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add inner 90% region to residuals (grey boxes in plot)</span></span></span>
<span class="r-in"><span><span class="co"># Vertical grey box shows matching y-values</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span>, q <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 9.74 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 11.56 units, or about 118.7% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change guide to encompass mid 75% of residual values</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span>, q <span class="op">=</span> <span class="cn">TRUE</span>, inner <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 75.0% of residuals covers about 7.70 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 11.56 units, or about 150.1% of the mid 75.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use median instead of the mean to compute group summaries and to</span></span></span>
<span class="r-in"><span><span class="co"># recenter the fitted values around 0.</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span>, stat <span class="op">=</span> <span class="va">median</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 9.99 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 10.80 units, or about 108.1% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apply power transformation of -1 to mpg. Defaults to box-cox method.</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span>, p <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 0.03 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 0.03 units, or about 101.0% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display a stacked bar plot showing relative importance in spreads</span></span></span>
<span class="r-in"><span><span class="co"># between fitted values and residuals.</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">mtcars</span>,<span class="va">mpg</span>, <span class="va">cyl</span>, bar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 9.74 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 11.56 units, or about 118.7% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate rfs plot for bivariate model output. Model can be generated from</span></span></span>
<span class="r-in"><span><span class="co"># lm(), eda_lm() or eda_rline()</span></span></span>
<span class="r-in"><span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">hp</span> <span class="op">~</span> <span class="va">mpg</span>, <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">M1</span>,q <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 112.42 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 207.50 units, or about 184.6% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="eda_lm.html">eda_lm</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">mpg</span>, <span class="va">hp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="eda_rfs-8.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        int      mpg^1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 324.082314  -8.829731 </span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">M2</span>,q <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 112.42 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 207.50 units, or about 184.6% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M3</span> <span class="op">&lt;-</span> <span class="fu"><a href="eda_rline.html">eda_rline</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">mpg</span>, <span class="va">hp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">eda_rfs</span><span class="op">(</span><span class="va">M3</span>, q <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mid 90.0% of residuals covers about 122.52 units.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitted values cover a range of 252.28 units, or about 205.9% of the mid 90.0% of residuals.</span>
<span class="r-plt img"><img src="eda_rfs-10.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Manuel Gimond.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

